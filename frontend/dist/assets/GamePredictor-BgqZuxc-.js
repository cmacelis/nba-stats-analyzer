import{c as ae,j as e,B as l,f as fe,s as be,D as ge,E as je,C as te,T as c,x as ye,u as ve,r as d,P as F,y as Se,w as Ce,I as ke,A as C,z as Pe}from"./index-D938L-uP.js";import{C as Ie,P as J,R as we}from"./PlayerSearch-CAH_JiYB.js";import{a as Be,F as Te,I as Ve,S as Fe,M as Re,P as K}from"./PlayerAvatar-8fWb5i2t.js";import{C as Ee,R as Le,P as ze,L as Ae,i as We,p as Me,a as He,b as De,U as Ge}from"./index-BXa-xqdH.js";import{e as Q,f as Y,T as Ne,a as Ue,c as q,d as g,b as _e}from"./useNbaData-D8nRe-iJ.js";import{m as X}from"./dataMappers-BRDJy-Uq.js";import{G as z}from"./Grid-DoL_7ZEi.js";import{T as $e,a as A}from"./ToggleButtonGroup-CvrtXAXh.js";import{C as Oe}from"./Chip-D3osFpNB.js";import{T as Je}from"./TableHead-lIVOiREc.js";const Ke=ae(e.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack"),Qe=ae(e.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),Ye={fadeIn:fe,slideIn:be,pulse:ge,bounce:je},qe=({animation:s="fadeIn",delay:i=0,children:a,sx:u,...n})=>e.jsx(l,{sx:{animation:`${Ye[s]} 0.5s ease-out ${i}s`,animationFillMode:"backwards",...u},...n,children:a}),Xe=({message:s="Loading stats..."})=>e.jsxs(l,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.7)",zIndex:1e3,borderRadius:1},children:[e.jsx(te,{size:48,sx:{mb:2}}),e.jsx(c,{variant:"body1",color:"white",children:s})]});Ee.register(Le,ze,Ae,We,Me,He);const V=[{key:"points",label:"Points",max:35},{key:"assists",label:"Assists",max:12},{key:"rebounds",label:"Rebounds",max:15},{key:"steals",label:"Steals",max:3},{key:"blocks",label:"Blocks",max:3},{key:"playerEfficiencyRating",label:"PER",max:30}],Ze=({player1:s,player2:i,stats1:a,stats2:u,isLoading:n=!1})=>{const r=ye(),{playSound:m}=ve(),[y,h]=d.useState(!1);d.useEffect(()=>{h(!0),m("switch")},[s.id,i.id,m]);const j=d.useMemo(()=>!a||!u?null:{labels:V.map(o=>o.label),datasets:[{label:s.name,data:V.map(o=>a[o.key]),backgroundColor:`${r.palette.primary.main}40`,borderColor:r.palette.primary.main,borderWidth:2,pointBackgroundColor:r.palette.primary.main,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:r.palette.primary.main,pointRadius:4,pointHoverRadius:6},{label:i.name,data:V.map(o=>u[o.key]),backgroundColor:`${r.palette.secondary.main}40`,borderColor:r.palette.secondary.main,borderWidth:2,pointBackgroundColor:r.palette.secondary.main,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:r.palette.secondary.main,pointRadius:4,pointHoverRadius:6}]},[s,i,a,u,r.palette]);if(n||!a||!u)return e.jsxs(F,{sx:{p:3,mb:3,position:"relative",minHeight:400},children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Performance Comparison"}),n?e.jsx(Xe,{message:"Loading player stats..."}):e.jsx(l,{sx:{height:400,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(c,{color:"text.secondary",children:"Stats not available"})})]});const v=j,S={scales:{r:{min:0,max:Math.max(...V.map(o=>o.max)),ticks:{stepSize:5,callback:o=>o.toFixed(0)},pointLabels:{font:{size:12,weight:"bold"}},grid:{color:r.palette.divider},angleLines:{color:r.palette.divider}}},plugins:{legend:{position:"top",labels:{padding:20,usePointStyle:!0,pointStyle:"circle"}},tooltip:{backgroundColor:r.palette.background.paper,titleColor:r.palette.text.primary,bodyColor:r.palette.text.secondary,borderColor:r.palette.divider,borderWidth:1,padding:12,displayColors:!0,callbacks:{label:o=>{const R=o.raw;return`${o.dataset.label}: ${R.toFixed(1)}`}}}},animation:{duration:1e3,easing:"easeInOutQuart"},responsive:!0,maintainAspectRatio:!1};return e.jsx(qe,{children:e.jsxs(F,{sx:{p:3,mb:3},children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Performance Comparison"}),e.jsx(Be,{in:y,timeout:1e3,children:e.jsx(l,{sx:{height:400},children:e.jsx(De,{data:v,options:S})})})]})})};function Z(s){return s.pts*1+s.ast*1.5+s.reb*.8+s.stl*2.5+s.blk*2+s.fg_pct*20+s.ft_pct*5-s.turnover*2}function ea(s,i,a){const u=Z(s),n=Z(i),r=a===1?3.5:a===2?-3.5:0,m=Math.max(-25,Math.min(25,(u-n)*.15+r)),y=1/(1+Math.exp(-.2*m))*100,h=110,j=[{label:"Points/Game",team1Value:s.pts,team2Value:i.pts,higherIsBetter:!0},{label:"Rebounds",team1Value:s.reb,team2Value:i.reb,higherIsBetter:!0},{label:"Assists",team1Value:s.ast,team2Value:i.ast,higherIsBetter:!0},{label:"FG%",team1Value:+(s.fg_pct*100).toFixed(1),team2Value:+(i.fg_pct*100).toFixed(1),higherIsBetter:!0},{label:"Stl + Blk",team1Value:+(s.stl+s.blk).toFixed(1),team2Value:+(i.stl+i.blk).toFixed(1),higherIsBetter:!0},{label:"Turnovers",team1Value:s.turnover,team2Value:i.turnover,higherIsBetter:!1}].map(o=>({...o,winner:o.higherIsBetter?o.team1Value>o.team2Value?1:o.team2Value>o.team1Value?2:"tie":o.team1Value<o.team2Value?1:o.team2Value<o.team1Value?2:"tie"})),v=Math.abs(u-n),S=v>10?"high":v>5?"medium":"low";return{team1WinProbability:y,projectedScore1:Math.round(h+m/2),projectedScore2:Math.round(h-m/2),pointSpread:m,confidence:S,advantages:j}}function aa(s){return s==="high"?"success":s==="medium"?"warning":"error"}function ee(s){const i=s.split(" ");return i[i.length-1]}const k=[{value:2025,label:"2025-26"},{value:2024,label:"2024-25"},{value:2023,label:"2023-24"},{value:2022,label:"2022-23"},{value:2021,label:"2021-22"}],ua=()=>{var D,G,N,U;const[s,i]=Se(),[a,u]=d.useState(null),[n,r]=d.useState(null),[m,y]=d.useState(null),[h,j]=d.useState(2025),[v,S]=d.useState(!1),o=d.useRef(null);d.useEffect(()=>{const t=s.get("p1"),b=s.get("p1n"),P=s.get("p1t"),I=s.get("p2"),T=s.get("p2n"),he=s.get("p2t"),_=s.get("s"),$=s.get("hc");if(t&&b&&u({id:parseInt(t),name:b,team:P||"",position:""}),I&&T&&r({id:parseInt(I),name:T,team:he||"",position:""}),_){const O=parseInt(_);k.some(xe=>xe.value===O)&&j(O)}$&&y($)},[]),d.useEffect(()=>{const t={s:h.toString()};a&&(t.p1=a.id.toString(),t.p1n=a.name,t.p1t=a.team),n&&(t.p2=n.id.toString(),t.p2n=n.name,t.p2t=n.team),m&&(t.hc=m),i(t,{replace:!0})},[a,n,h,m,i]);const R=(t,b)=>{u(t),r(b),j(2025),setTimeout(()=>{var P;(P=o.current)==null||P.scrollIntoView({behavior:"smooth",block:"start"})},50)},W=m==="1"?1:m==="2"?2:null,{data:x,isLoading:w,isError:M,isFallback:ne,effectiveSeason:se}=Q((a==null?void 0:a.id.toString())??"",h),{data:f,isLoading:B,isError:H,isFallback:oe,effectiveSeason:re}=Q((n==null?void 0:n.id.toString())??"",h),E=!!(x!=null&&x.pts),L=!!(f!=null&&f.pts),{data:ie}=Y(!(a!=null&&a.photoUrl)&&a?a.name:""),{data:le}=Y(!(n!=null&&n.photoUrl)&&n?n.name:""),ce=(a==null?void 0:a.photoUrl)??ie??void 0,de=(n==null?void 0:n.photoUrl)??le??void 0,p=d.useMemo(()=>!E||!L?null:ea(x,f,W),[x,f,W,E,L]);d.useEffect(()=>{if(!p)return;const t="nba_prediction_log",b=Date.now()-30*24*60*60*1e3,I=JSON.parse(localStorage.getItem(t)||"[]").filter(T=>new Date(T).getTime()>b);I.push(new Date().toISOString()),localStorage.setItem(t,JSON.stringify(I))},[p]);const me=d.useMemo(()=>x?X(x):void 0,[x]),ue=d.useMemo(()=>f?X(f):void 0,[f]),pe=w||B;return e.jsxs(l,{sx:{p:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(c,{variant:"h4",children:"Matchup Edge"}),e.jsx(Ce,{title:"Copy shareable link",children:e.jsx(ke,{size:"small",onClick:()=>{navigator.clipboard.writeText(window.location.href),S(!0)},children:e.jsx(Ie,{fontSize:"small"})})})]}),e.jsx(c,{color:"text.secondary",sx:{mb:3},children:"Select each team's star player to predict the game outcome."}),e.jsx(Ge,{onSelectGame:R}),e.jsxs(z,{ref:o,container:!0,spacing:3,sx:{mb:3},children:[e.jsx(z,{item:!0,xs:12,md:6,children:e.jsx(J,{label:"Team 1 Star Player",value:a,onChange:u})}),e.jsx(z,{item:!0,xs:12,md:6,children:e.jsx(J,{label:"Team 2 Star Player",value:n,onChange:r})})]}),e.jsxs(l,{sx:{mb:3,display:"flex",alignItems:"center",gap:2},children:[e.jsx(c,{variant:"body1",fontWeight:"medium",children:"Season:"}),e.jsxs(Te,{size:"small",children:[e.jsx(Ve,{id:"season-label",children:"Season"}),e.jsx(Fe,{labelId:"season-label",value:h,label:"Season",onChange:t=>j(t.target.value),children:k.map(t=>e.jsx(Re,{value:t.value,children:t.label},t.value))})]})]}),e.jsxs(l,{sx:{mb:3,display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx(c,{variant:"body1",fontWeight:"medium",children:"Home Court:"}),e.jsxs($e,{value:m,exclusive:!0,onChange:(t,b)=>y(b),size:"small",children:[e.jsx(A,{value:"1",children:(a==null?void 0:a.name)??"Team 1"}),e.jsx(A,{value:"neutral",children:"Neutral"}),e.jsx(A,{value:"2",children:(n==null?void 0:n.name)??"Team 2"})]})]}),a&&!w&&M&&e.jsxs(C,{severity:"error",sx:{mb:2},children:["Could not load stats for ",a.name,". The stats API may be unavailable — check that your BallDontLie API key is set and your plan includes season averages."]}),n&&!B&&H&&e.jsxs(C,{severity:"error",sx:{mb:2},children:["Could not load stats for ",n.name,". The stats API may be unavailable — check that your BallDontLie API key is set and your plan includes season averages."]}),a&&!w&&ne&&e.jsxs(C,{severity:"info",sx:{mb:2},children:["Not enough ",(D=k.find(t=>t.value===h))==null?void 0:D.label," games yet to compute a reliable average for ",a.name," — showing ",(G=k.find(t=>t.value===se))==null?void 0:G.label,"."]}),n&&!B&&oe&&e.jsxs(C,{severity:"info",sx:{mb:2},children:["Not enough ",(N=k.find(t=>t.value===h))==null?void 0:N.label," games yet to compute a reliable average for ",n.name," — showing ",(U=k.find(t=>t.value===re))==null?void 0:U.label,"."]}),a&&!w&&!M&&x!==void 0&&!E&&e.jsxs(C,{severity:"info",sx:{mb:2},children:["No season averages found for ",a.name,". Try selecting an older season."]}),n&&!B&&!H&&f!==void 0&&!L&&e.jsxs(C,{severity:"info",sx:{mb:2},children:["No season averages found for ",n.name,". Try selecting an older season."]}),pe&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",my:4},children:e.jsx(te,{})}),p&&a&&n&&e.jsxs(e.Fragment,{children:[e.jsxs(F,{sx:{p:3,mb:3},children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Win Probability"}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(K,{name:a.name,photoUrl:ce,size:48}),e.jsxs(c,{variant:"body2",fontWeight:"bold",color:"primary.main",children:[a.name," (",p.team1WinProbability.toFixed(0),"%)"]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(c,{variant:"body2",fontWeight:"bold",color:"secondary.main",children:[n.name," (",(100-p.team1WinProbability).toFixed(0),"%)"]}),e.jsx(K,{name:n.name,photoUrl:de,size:48})]})]}),e.jsxs(l,{sx:{display:"flex",height:36,borderRadius:1,overflow:"hidden"},children:[e.jsx(l,{sx:{width:`${p.team1WinProbability}%`,bgcolor:"primary.main",transition:"width 0.5s ease"}}),e.jsx(l,{sx:{width:`${100-p.team1WinProbability}%`,bgcolor:"secondary.main",transition:"width 0.5s ease"}})]}),e.jsxs(l,{sx:{mt:2,display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsxs(c,{variant:"body1",children:["Projected Score:"," ",e.jsxs("strong",{children:[a.team," ",p.projectedScore1]})," ","–"," ",e.jsxs("strong",{children:[n.team," ",p.projectedScore2]})]}),e.jsx(Oe,{label:`${p.confidence.charAt(0).toUpperCase()+p.confidence.slice(1)} Confidence`,color:aa(p.confidence),size:"small"})]})]}),e.jsxs(F,{sx:{p:3,mb:3},children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Stat Breakdown"}),e.jsx(Ne,{children:e.jsxs(Ue,{size:"small",children:[e.jsx(Je,{children:e.jsxs(q,{children:[e.jsx(g,{children:"Stat"}),e.jsx(g,{align:"center",children:a.name}),e.jsx(g,{align:"center",children:n.name}),e.jsx(g,{align:"center",children:"Edge"})]})}),e.jsx(_e,{children:p.advantages.map(t=>e.jsxs(q,{children:[e.jsx(g,{children:t.label}),e.jsx(g,{align:"center",sx:{fontWeight:t.winner===1?"bold":"normal",color:t.winner===1?"primary.main":"text.primary"},children:t.team1Value}),e.jsx(g,{align:"center",sx:{fontWeight:t.winner===2?"bold":"normal",color:t.winner===2?"secondary.main":"text.primary"},children:t.team2Value}),e.jsx(g,{align:"center",children:t.winner==="tie"?e.jsx(we,{fontSize:"small",color:"disabled"}):t.winner===1?e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:.5,color:"primary.main"},children:[e.jsx(Ke,{fontSize:"small",color:"primary"}),e.jsx(c,{variant:"caption",color:"primary",children:ee(a.name)})]}):e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:.5,color:"secondary.main"},children:[e.jsx(c,{variant:"caption",color:"secondary",children:ee(n.name)}),e.jsx(Qe,{fontSize:"small",color:"secondary"})]})})]},t.label))})]})})]}),e.jsx(Ze,{player1:a,player2:n,stats1:me,stats2:ue,isLoading:!1})]}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{mt:2,display:"block",textAlign:"center"},children:"Note: Predictions use the most recent available season averages (auto-fallback if needed) and are for entertainment purposes only."}),e.jsx(Pe,{open:v,autoHideDuration:2e3,onClose:()=>S(!1),message:"Link copied to clipboard"})]})};export{ua as default};
//# sourceMappingURL=GamePredictor-BgqZuxc-.js.map
